
Добрый день меня зовут Кирилл Сетдеков

Это презентация финальной работы Решение задачи регрессии для многокомпонентных временных рядов для детектирования режимов работы насосного оборудования.

Основная задача этой работает построить прогноз производительности нефтяного центробежных насосов с использованием лучших современных алгоритмов и сравните их качество

Я расскажу про бенчмарк, который я использовал для отбора подходов и методы которые показывают лучшие результаты и потом перейду к описанию данных и выбранных подходов.

Я использовал для выбора методов benchmark ETTH2 720. Это числовые данные температуры трансформаторов за 2 года с прогнозов на 30 дней в в зависимости от 7  переменных. В реальной жизни важный бенчмарк - прогноз нагрузки на сеть и аномальных состояний, ведущих к отключениям. Справа можете увидеть какие типы модели показали лучший результат на этом бенчмарке. Между ними общее то, что три из четырех моделей этого трансформеры или их дальнейшее развитие, а одна модель с лучшим результатом - сверточная нейронная. Последнее время задачи машинного зрения и перевода, по мере развития отрасли стимулировали появление новых идеи, которые такж успешно показали себя и при переносе в область прогноза временных рядом.

В этой работе использует следующие данные и подходы: 2 месяца наблюдений за 17 насосами на нефтяном месторождении с разрешением 5 минут. Обучающая и валидационная выборка разделены по времени.

Всего использовал 5 подходов - базовая модель AutoML и четыре подхода входящих SOTA или предшествующие им: Time fusion transformers, TCN, просто Трансформеры и N-beats сезонностью

На этом слайде я подробно останавливается на иллюстрации целевой переменной и признаков

Целевая переменная это средняя скорость изменения давления на входе насоса остальные переменные это физические параметры на входе в измерительного устройства которые расположено на поверхности земли над скважиной. Интерес построения модели в том что можно за счёт более дешевых измерительных приборов на поверхности моделей оценить параметры связанные с ухудшением производительности насоса на глубине вместо использования дорогостоящих датчиков.
Справа динамика примеров переменных, их можно разделить на 2 группы - скорость изменения (загрузки, давления, тока в разрезе по часам, дням и месяцам) и вторая группа - мгновенные параметры (время работы, давление на выходе, коэффициент мощности, ток, загрузка двигателя)

О проблемах, с чем я столкнулся и как их решал

1. Мало данных и долго перебирать гиперпараметры - TFT переобучилсь
2. Само обучение обучение занимало до 20 часов даже на самых мощных картах в Colab и не удалось экстенсивно перебирать гиперпараметры
3. Удалось подобрать оптимальную для TFT модели скорость обучения, но этого было не достаточно.
4. Много сил заняло написание загрузчиков данных и их обработка перед обучением моделей.
5. Подбор окна для моделей удалось решить с помощью анализа частных автокорреляции

Далее мы видим сравнение метрик моделей на валидационной выборке, которая была позже по времени чем обучающая. Модель, которая показала себя лучше всего по по всем метрикам была TCN, а худшая по $R^2$ и MAE была модель N-Beats, а модель Time Fusion Transformers показала результат по 2 метрикам из 3 хуже, чем AutoML на бустингах

На этом слайде мы видим для двух разных насосов из выборки по валидации сравнение всех четырех моделей с фактом, то что TCN и Трансформеры ближе всего к пунктирной линии соответствует картине с прошлого слайда по сравнению итоговых метрик на валидации.

На этом слайде можем увидеть распределения остатков моделей на валидации. Для всех моделей самым сложным для предсказания регион константных значений, соответствует единицам на этих графиках

На этом слайде и следующем приведена дополнительная визуализация для внимания, которое содержится в TFT. Хотя модель показал себя плохо в метриках, мы можем лучше понять, как принимается решение и строится прогноз. Слева мы видим какая активация этой модели в части временного домена на графике слева. По сути, как далеко и на что смотрит модель делая прогноз - на локальную информацию и пик около -150 - как раз на поведение при прошлом включении.

Справа приведены выводы значимости признаков для энкодера - время простоя, средняя скорость измерения давления в неделю и ток фазы насос были наиболее значимы

На следующим слайде - аналогично справа для декодера коэффициент мощности, время работы насоса и объем наработки кубометров в сутки самые значимые. Слева - анализ значимости для статических переменных по сути выделены насосы для которых было сильнее всего отклонение от типичного поведения для этой популяции.

Переходя к результатам:

1. для  3 из четырех модели удалось показать качество лучше чем AutoML 4,4% SMAPE и  ниже 1,5% для одного из насосов
2. У TFT модели в моей работе на этих данных была тенденция к переобучению - это дальнейший план сжимать число параметром, упрощать модель и сильнее регуляризовать, она должна работать не хуже трансформеров классических
3. Для моделей трансформеров анализ attention позволяет гибче анализировать и интерпретировать их работу

Дополнительно в качестве иллюстраций, можно посмотреть пример сравнения  факта и прогноза для каждой из четырех моделей где чёрная линия это реальное значение и синее - прогноз.
TCN
Трансформер
Н-Битс
Тайм фьюжн трансформер

